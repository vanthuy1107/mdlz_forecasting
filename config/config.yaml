# MDLZ Warehouse Quantity Prediction System Configuration

# Data Configuration
data:
  data_dir: "./dataset"  # Directory containing combined year files (data_2022.csv, data_2023.csv, etc.)
  file_pattern: "data_{year}.csv"  # Pattern for combined year files
  years: [2023, 2024]
  
 
  feature_cols:
    - "month_sin"
    - "month_cos"
    - "dayofmonth_sin"
    - "dayofmonth_cos"
    - "is_weekend"
    - "dow_sin"
    - "dow_cos"
    # - "weekday_volume_tier"
    # - "is_high_volume_weekday"
    # - "is_EOM"
    # - "days_until_month_end"
    # - "lunar_month"
    # - "lunar_day"
    # - "lunar_month_sin"
    # - "lunar_month_cos"
    # - "lunar_day_sin"
    # - "lunar_day_cos"
    - "is_off_holiday"
    - "is_other_holiday"
    # - "days_until_next_holiday"
    # - "days_since_holiday"
    # - "days_to_tet"
    # - "cbm_per_qty"
    # - "cbm_per_qty_last_year"
    # - "baseline"
    # - "CUBE_OUT"
  
  # Target column
  target_col: "CUBE_OUT"
  
  # Category column
  brand_col: "BRAND"
  brand_id_col: "BRAND_ID"
  time_col: "DATE"

# Window configuration
# Direct Multi-step Forecasting: Use longer context (60 days) to predict entire horizon (30 days) at once
# This prevents exposure bias from recursive forecasting where errors compound
window:
  input_size: 7
  horizon: 2    

# Model Configuration
model:
  name: "RNNForecastor" 
  num_brands: null  # Will be set dynamically from data
  brand_emb_dim: 4
  input_dim: null  # Updated dynamically in code to match feature_cols length
  hidden_size: 16
  n_layers: 2
  output_dim: 2  # Changed from 1 to 30 to output entire forecast horizon at once (direct multi-step)
  dropout_prob: 0.1  # Only for RNNForecastor

# Training Configuration
training:
  batch_size: 64
  val_batch_size: 16
  test_batch_size: 16
  epochs: 20
  learning_rate: 0.001
  optimizer: "Adam"
  loss: "Huber"
  
  
  # Learning rate scheduler
  scheduler:
    name: "ReduceLROnPlateau"
    mode: "min"
    factor: 0.5
    patience: 3
    min_lr: 0.00001
  
  # Logging
  log_interval: 5  # Log every N epochs
  
  # Device
  device: "auto"  # "auto", "cuda", or "cpu"

# Output Configuration
output:
  output_dir: "../outputs"
  save_model: true
  model_dir: "../outputs/mvp_test/models"
  
  # Visualization
  visualize:
    save_plots: true

# Inference Configuration
inference:
  n_samples_for_plot: 100
  save_predictions: true
  
  test_data_path: "dataset/data_2025.csv"  # CSV with future period to predict
  test_start: "2025-01-01"  # Inclusive start date (YYYY-MM-DD)
  test_end: "2025-12-31"    # Inclusive end date (YYYY-MM-DD); rolling prediction automatically handles long ranges

